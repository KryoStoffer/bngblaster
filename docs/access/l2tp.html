<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>L2TP &mdash; BNG Blaster 0.9 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=411f5019" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=049aceee"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="L2BSA" href="l2bsa.html" />
    <link rel="prev" title="IPoE" href="ipoe.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BNG Blaster
              <img src="../_static/rtbrick_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interfaces.html">Interfaces</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Access Protocols</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pppoe.html">PPPoE</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipoe.html">IPoE</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">L2TP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variable-data-header">Variable Data Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rfc5515">RFC5515</a></li>
<li class="toctree-l3"><a class="reference internal" href="#l2tp-commands">L2TP Commands</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="l2bsa.html">L2BSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="traffic.html">Session Traffic</a></li>
<li class="toctree-l2"><a class="reference internal" href="multicast.html">Multicast and IPTV</a></li>
<li class="toctree-l2"><a class="reference internal" href="li.html">Legal Interception (LI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="monkey.html">Monkey</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../routing/index.html">Routing Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../streams.html">Traffic Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http.html">HTTP Emulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nat.html">NAT / CGNAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reports.html">Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API/CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controller.html">Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BNG Blaster</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Access Protocols</a></li>
      <li class="breadcrumb-item active">L2TP</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/access/l2tp.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="l2tp">
<span id="id1"></span><h1>L2TP<a class="headerlink" href="#l2tp" title="Link to this heading"></a></h1>
<p>The BNG Blaster can emulate L2TPv2 (RFC2661) LNS servers to
be able to test the L2TPv2 LAC functionality of the BNG device under
test.</p>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h2>
<p>Following an example with 30 L2TP LNS servers.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;interfaces&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;network&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;interface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;eth2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;gateway&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address-ipv6&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fc66:1337:7331:8::10&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;gateway-ipv6&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fc66:1337:7331:8::1&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;access&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;interface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;eth1&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;outer-vlan-min&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;outer-vlan-max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4000</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;inner-vlan-min&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;inner-vlan-max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;authentication-protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PAP&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;interface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;eth1&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;outer-vlan-min&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;outer-vlan-max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4000</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;inner-vlan-min&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;inner-vlan-max&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;authentication-protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CHAP&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;pppoe&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;reconnect&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;discovery-timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;discovery-retry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;ppp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;mru&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1492</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;authentication&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;blaster@l2tp.de&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;retry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;lcp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;conf-request-timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;conf-request-retry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;keepalive-interval&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;keepalive-retry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;ipcp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;ip6cp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;access-line&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;agent-remote-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DEU.RTBRICK.{session}&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;agent-circuit-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.0.0.0/0.0.0.0 eth 0:{session}&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;rate-up&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;rate-down&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16384</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;l2tp-server&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.11&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.12&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS3&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.13&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test3&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS4&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.14&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test4&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS5&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.15&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test5&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS6&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.16&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test6&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS7&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.17&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test7&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS8&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.18&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test8&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS9&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.19&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test9&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS10&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.20&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test10&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS11&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.21&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test11&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS12&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.22&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test12&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS13&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.23&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test13&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS14&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.24&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test14&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS15&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.25&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test15&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS16&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.26&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test16&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS17&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.27&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test17&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS18&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.28&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test18&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS19&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.29&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test19&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS20&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.30&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test20&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS21&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.31&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test21&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS22&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.32&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test22&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS23&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.33&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test23&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS24&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.34&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test24&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS25&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.35&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test25&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS26&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.36&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test26&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS27&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.37&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test27&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS28&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.38&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test28&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS29&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.39&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test29&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS30&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.40&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test30&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;session-traffic&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;autostart&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;ipv4-pps&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;l2tp-server&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>name</strong></p></td>
<td><div class="line-block">
<div class="line">Mandatory L2TP LNS server hostname (AVP 7)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>address</strong></p></td>
<td><div class="line-block">
<div class="line">Mandatory L2TP server address.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>secret</strong></p></td>
<td><div class="line-block">
<div class="line">Tunnel secret.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>receive-window-size</strong></p></td>
<td><div class="line-block">
<div class="line">Control messages receive window size.</div>
<div class="line">Default: 16 Range: 1 - 65535</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>max-retry</strong></p></td>
<td><div class="line-block">
<div class="line">Control messages max retry.</div>
<div class="line">Default: 5 Range: 1 - 65535</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>congestion-mode</strong></p></td>
<td><div class="line-block">
<div class="line">Control messages congestion mode (default, slow or aggressive).</div>
<div class="line">The BNG Blaster supports different congestion modes for the</div>
<div class="line">reliable delivery of control messages. The default mode is</div>
<div class="line">described in RFC2661 appendix A (Control Channel Slow Start and</div>
<div class="line">Congestion Avoidance). The mode slow uses a fixed control window</div>
<div class="line">size of 1 where aggressive sticks to max permitted based on peer</div>
<div class="line">received window size.</div>
<div class="line">Default: default</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>hello-interval</strong></p></td>
<td><div class="line-block">
<div class="line">Set hello interval.</div>
<div class="line">Default: 30 Range: 1 - 65535</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>data-control-priority</strong></p></td>
<td><div class="line-block">
<div class="line">Set the priority bit in the L2TP header for all non-IP data</div>
<div class="line">packets (LCP, IPCP, …).</div>
<div class="line">Default: false</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>data-length</strong></p></td>
<td><div class="line-block">
<div class="line">Set length bit for all data packets.</div>
<div class="line">Default: false</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>data-offset</strong></p></td>
<td><div class="line-block">
<div class="line">Set offset bit with offset zero for all data packets.</div>
<div class="line">Default: false</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>control-tos</strong></p></td>
<td><div class="line-block">
<div class="line">Set L2TP control traffic (SCCRQ, ICRQ, …) TOS priority.</div>
<div class="line">Default: 0 Range: 0 - 255</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>data-control-tos</strong></p></td>
<td><div class="line-block">
<div class="line">Set the L2TP tunnel TOS priority (outer IPv4 header) for all</div>
<div class="line">non-IP data packets (LCP, IPCP, …).</div>
<div class="line">Default: 0 Range: 0 - 255</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p><strong>lcp-padding</strong></p></td>
<td><div class="line-block">
<div class="line">Add fixed padding to LCP packets send from LNS.</div>
<div class="line">Default: 0 Range: 0 - 65535</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p><strong>client-auth-id</strong></p></td>
<td><div class="line-block">
<div class="line">Add optional check based on client-auth-id to support multiple</div>
<div class="line">LNS server configurations with the same IP address.</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="variable-data-header">
<h2>Variable Data Header<a class="headerlink" href="#variable-data-header" title="Link to this heading"></a></h2>
<p>The L2TP protocol allows different data header options resulting in
variable header lengths. The most common options can be tested with just
four servers as shown in the example below.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;l2tp-server&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.11&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;congestion-mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-control-priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.12&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;congestion-mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-control-priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-length&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS3&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.11&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test3&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;congestion-mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-control-priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-offset&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS4&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.12&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test4&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;receive-window-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;congestion-mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-control-priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-length&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-offset&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="rfc5515">
<h2>RFC5515<a class="headerlink" href="#rfc5515" title="Link to this heading"></a></h2>
<p>The Agent-Circuit-Id and Agent-Remote-Id AVP defined in RFC5515
is supported and stored for each session if received. Received
CSUN messages are processed correctly and via the control socket,
it is possible to send also CSURQ requests to the LAC.</p>
</section>
<section id="l2tp-commands">
<h2>L2TP Commands<a class="headerlink" href="#l2tp-commands" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="../api/index.html#api"><span class="std std-ref">command</span></a> <code class="docutils literal notranslate"><span class="pre">session-info</span> <span class="pre">l2tp-tunnels</span></code> provides
detailed information about L2TP tunnels.</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">bngblaster-cli</span> <span class="pre">run.sock</span> <span class="pre">l2tp-tunnels</span></code></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ok&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;l2tp-tunnels&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Established&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;server-name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LNS1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;server-address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.11&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;tunnel-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-tunnel-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50011</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BNG&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.0.0.2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-vendor&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RtBrick, Inc.&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;control-packets-rx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">102</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;control-packets-rx-dup&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;control-packets-rx-out-of-order&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;control-packets-tx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">102</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;control-packets-tx-retry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-packets-rx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1406</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-packets-tx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">206</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">l2tp-sessions</span></code> <a class="reference internal" href="../api/index.html#api"><span class="std std-ref">command</span></a> returns all L2TP sessions.</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">bngblaster-cli</span> <span class="pre">run.sock</span> <span class="pre">l2tp-sessions</span></code></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ok&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;l2tp-sessions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Established&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;tunnel-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;session-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-tunnel-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50011</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-session-id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">32867</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-proxy-auth-name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;blaster@l2tp.de&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-called-number&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;N/A&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-calling-number&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;N/A&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-sub-address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;N/A&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-tx-bps&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">48000</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-rx-bps&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-ari&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DEU.RTBRICK.1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;peer-aci&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.0.0.0/0.0.0.0 eth 0:1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-packets-rx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">79</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-packets-tx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">79</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-ipv4-packets-rx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data-ipv4-packets-tx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This output can be also filtered to return only sessions
of a given tunnel.</p>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">bngblaster-cli</span> <span class="pre">run.sock</span> <span class="pre">l2tp-sessions</span> <span class="pre">tunnel-id</span> <span class="pre">1</span></code></p>
<p>It is also possible to display a single session.</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">bngblaster-cli</span> <span class="pre">run.sock</span> <span class="pre">l2tp-sessions</span> <span class="pre">tunnel-id</span> <span class="pre">1</span> <span class="pre">session-id</span> <span class="pre">1</span></code></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ipoe.html" class="btn btn-neutral float-left" title="IPoE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="l2bsa.html" class="btn btn-neutral float-right" title="L2BSA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2024, RtBrick, Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>